<!-- dashboard.component.html -->
<div class="dashboard-container">
    <!-- Sidebar -->
    
    
    <!-- Main Content -->
    <main class="main-content">
      <ng-container *ngIf="!loading; else loader">
        <!-- Stats Cards -->
        <!--<div class="stats-grid">
          <div class="stat-card" *ngFor="let stat of statsCards">
            <h3>{{ stat.title }}</h3>
            <p class="stat-value" [ngSwitch]="stat.type">
              <span *ngSwitchCase="'currency'">{{ stat.value | currency:'CAD':'symbol':'1.2-2' }}</span>
              <span *ngSwitchDefault>{{ stat.value }}</span>
            </p>
          </div>
        </div>-->
        
        <!-- Graphique et Calendrier -->
        <div class="content-grid">
          <!-- Graphique -->
          <!--<div class="chart-container">
            <h3>income</h3>
            <canvas #incomeChart style="height: 300px; width: 100%;"></canvas>

          </div>-->
          <div class="my-work">
  <h3>My Work</h3>

  <div class="period-filters">
    <label><input type="radio" name="period" value="today" [(ngModel)]="selectedFilter" (change)="applyFilter()"> Today</label>
    <label><input type="radio" name="period" value="all" [(ngModel)]="selectedFilter" (change)="applyFilter()"> All</label>
    <label>
      From <input type="date" [(ngModel)]="fromDate" (change)="selectedFilter='range';applyFilter()">
    </label>
    <label>
      To <input type="date" [(ngModel)]="toDate" (change)="selectedFilter='range';applyFilter()">
    </label>
  </div>

  <div class="summary">
    <div><strong>Base Rate:</strong> {{ baseRate | currency:'CAD':'symbol':'1.2-2' }}</div>
    <div><strong>Total Work Orders:</strong> {{ summary.totalWorkOrders }}</div>
    <div><strong>Confirmed Hours:</strong> {{ summary.confirmedHours | number:'1.2-2' }}</div>
    <div><strong>Base Payouts:</strong> {{ summary.basePayouts | currency:'CAD':'symbol':'1.2-2' }}</div>
    <div><strong>My Client-Funded ISF Savings:</strong> {{ summary.isf | currency:'CAD':'symbol':'1.2-2' }}</div>
    <div><strong>Work Expenses:</strong> {{ summary.workExpenses | currency:'CAD':'symbol':'1.2-2' }}</div>
  </div>

  <table class="orders-log">
    <thead>
      <tr>
        <th>Date</th>
        <th>Address</th>
        <th>Confirmed Hours</th>
        <th>Base Payouts</th>
        <th>ISF <small>(Applied on base rate only)</small></th>
        <th>Work Expenses</th>
        <th>Invoice Status</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let o of filteredOrders">
        <td>{{ o.executionDate | date:'shortDate' }}</td>
        <td>{{ o.jobAddress }}</td>
        <td>{{ parseDuration(o.orderDuration) | number:'1.2-2' }}</td>
        <td>{{ baseRate * parseDuration(o.orderDuration) | currency:'CAD':'symbol':'1.2-2' }}</td>
        <td>{{ baseRate * parseDuration(o.orderDuration) * 0.10 | currency:'CAD':'symbol':'1.2-2' }}</td>
        <td>{{ 0 | currency:'CAD':'symbol':'1.2-2' }}</td>
        <td>{{ invoiceStatusMap[o.orderID] || 'N/A' }}</td>
      </tr>
    </tbody>
  </table>
</div>


        </div>
      </ng-container>
    </main>
  </div>
  
  <!-- Loader -->
  <ng-template #loader>
    <div class="loading-overlay">
      <mat-spinner diameter="50"></mat-spinner>
      <p>Chargement des donn√©es...</p>
    </div>
  </ng-template>
