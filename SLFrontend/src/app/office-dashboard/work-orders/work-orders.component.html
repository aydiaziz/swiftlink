<div class="filters">
  <div class="date-options">
    <button (click)="dateFilter='today';applyFilters()">Today</button>
    <button (click)="dateFilter='all';applyFilters()">All</button>
    <label>
      From <input type="date" [(ngModel)]="fromDate" (change)="dateFilter='range';applyFilters()">
    </label>
    <label>
      To <input type="date" [(ngModel)]="toDate" (change)="dateFilter='range';applyFilters()">
    </label>
  </div>
  <div class="contractor-select">
    <select [(ngModel)]="selectedContractor" (change)="applyFilters()">
      <option [ngValue]="null">Contractors</option>
      <option *ngFor="let c of contractors" [ngValue]="c">{{c.email}}</option>
    </select>
  </div>
  <div class="badge">Work orders: {{filteredOrders.length}}</div>
</div>

<div class="summary-grid">
    <h2 class="section-title">Rate</h2>
  <div class="summary-card">
    <h4>Median Base Rate</h4>
    <p class="value">{{rateSummary.median | currency:'USD':'symbol':'1.2-2'}}</p>
  </div>
  <div class="summary-card">
    <h4>Average Base Rate</h4>
    <p class="value">{{rateSummary.average | currency:'USD':'symbol':'1.2-2'}}</p>
  </div>
  <div class="summary-card">
    <h4>Maximum Base Rate</h4>
    <p class="value">{{rateSummary.max | currency:'USD':'symbol':'1.2-2'}}</p>
  </div>
  <div class="summary-card">
    <h4>Minimum Base Rate</h4>
    <p class="value">{{rateSummary.min | currency:'USD':'symbol':'1.2-2'}}</p>
  </div>
</div>

<div class="summary-grid">
    <h2 class="section-title">Activity summary</h2>
  <div class="summary-card">
    <h4>Total Work Orders</h4>
    <p class="value">{{activitySummary.total}}</p>
  </div>
  <div class="summary-card">
    <h4>Scheduled Work Orders</h4>
    <p class="value">{{activitySummary.scheduled}}</p>
  </div>
  <div class="summary-card">
    <h4>Canceled Work Orders</h4>
    <p class="value">{{activitySummary.canceled}}</p>
  </div>
  <div class="summary-card">
    <h4>Confirmed Hours</h4>
    <p class="value">{{activitySummary.confirmedHours}}</p>
  </div>
</div>

<div class="summary-grid">
    <h2 class="section-title">Sales and payement</h2>
  <div class="summary-card">
    <h4>Total Sales</h4>
    <p class="value">{{salesSummary.totalSales | currency:'USD':'symbol':'1.2-2'}}</p>
    
  </div>
  <div class="summary-card">
    <h4>Collected ISF</h4>
    <p class="value">{{salesSummary.collectedIsf | currency:'USD':'symbol':'1.2-2'}}</p>
    
  </div>
  <div class="summary-card">
    <h4>Pending Payments</h4>
    <p class="value">{{salesSummary.pendingPayments | currency:'USD':'symbol':'1.2-2'}}</p>
    
  </div>
  <div class="summary-card">
    <h4>Pending ISF</h4>
    <p class="value">{{salesSummary.pendingIsf | currency:'USD':'symbol':'1.2-2'}}</p>
    
  </div>
</div>

<table class="orders-table" >
  <thead>
    <tr>
      <th>Date</th>
      <th>Work order #</th>
      <th>Contractor</th>
      <th>Client Name</th>
      <th>Address</th>
      <th>Initial Work Description</th>
      <th>Final Work Description</th>
      <th>Contractor Notes</th>
      <th>Client Notes</th>
      <th>Worked Hours</th>
      <th>Rate</th>
      <th>Work Expenses</th>
      <th>Invoiced</th>
      <th>ISF</th>
      <th>Payment Status</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let o of filteredOrders">
      <td>{{ o.order.executionDate | date:'shortDate' }}</td>
      <td>{{ o.order.orderID }}</td>
      <td>{{ o.workforce.firstName }} {{ o.workforce.lastName }}</td>
      <td>{{ o.client.firstName }} {{ o.client.lastName }}</td>
      <td>{{ o.client.address }}</td>
      <td>{{ o.order.jobTitle }}</td>
      <td>{{ o.order.finalWorkDescription }}</td>
      <td>{{ o.order.contractorNotes }}</td>
      <td>{{ o.order.clientNotes }}</td>
      <td>{{ o.order.orderDuration }}</td>
      <td>{{ o.workforce.hourlyRatebyService | currency:'USD':'symbol':'1.2-2' }}</td>
      <td>{{ extrasTotal(o.invoice?.extras) | currency:'USD':'symbol':'1.2-2' }}</td>
      <td>{{ invoicedAmount(o) | currency:'USD':'symbol':'1.2-2' }}</td>
      <td>{{ (invoicedAmount(o) * 0.10) | currency:'USD':'symbol':'1.2-2' }}</td>
      <td>{{ o.invoice?.status || 'N/A' }}</td>
    </tr>
  </tbody>
</table>
<ng-template #empty>
  <p>No work orders found.</p>
</ng-template>
